642,643c642,643
< 	if len(data) < endq+4 {
< 		return 0, errors.New("DNS question too small")
---
> 	if endq+4 >= len(data) {
> 		return 0, errDecodeRecordLength
716,717c716,717
< 	if len(data) < endq+10 {
< 		return 0, errors.New("DNS record too small")
---
> 	if endq+10 >= len(data) {
> 		return 0, errDecodeRecordLength
731,734c731,732
< 	if rr.DataLength > 0 {
< 		if err = rr.decodeRData(data[:end], endq+10, buffer); err != nil {
< 			return 0, err
< 		}
---
> 	if err = rr.decodeRData(data[:end], endq+10, buffer); err != nil {
> 		return 0, err
